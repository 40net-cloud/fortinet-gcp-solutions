imports:
- path: vpc.jinja
- path: ha-ap.jinja
- path: license1.lic
- path: license2.lic

resources:
- name: HubVPC
  type: vpc.jinja
  properties:
    prefix: {{ env.deployment }}
    region: {{ properties["region"]}}
    hubNetwork: {{ properties["hubNetwork"]}}
    haNetwork: {{ properties["haNetwork"]}}
    mgmtNetwork: {{ properties["mgmtNetwork"]}}
    spokeNetworks: {{ properties["spokeNetworks"]}}
- name: Fortigate HA
  type: ha-ap.jinja
  properties:
    prefix: {{ env.deployment }}
    region: {{ properties.region }}
    zone1: {{ properties["zone1"]}}
    zone2: {{ properties["zone2"]}}
    instanceType: {{ properties["fgtInstanceType"]}}
    serviceAccount: {{ properties.fgtServiceAccount }}
    license: {{ properties.license }}
    version: {{ properties.version }}
    networks:
      data:
        vpc: $(ref.HubVPC.hubVpcRef)
        subnet: $(ref.HubVPC.hubSubnetRef)
        cidr: {{ properties.hubNetwork.ipCidrRange }}
      hasync:
        vpc: $(ref.HubVPC.haVpcRef)
        subnet: $(ref.HubVPC.haSubnetRef)
        cidr: {{ properties.haNetwork.ipCidrRange }}
      mgmt:
        vpc: $(ref.HubVPC.mgmtVpcRef)
        subnet: $(ref.HubVPC.mgmtSubnetRef)
        cidr: {{ properties.mgmtNetwork.ipCidrRange }}
